<%- include('../bootheader') -%>
<%- include('./menubar') -%>
<script type="text/javascript" src="/js/sort-table.js"></script>
<style type="text/css">
  th,
  td {
    border: 1px solid black
  }
</style>
<div class="p-3 mb-4 bg-light">
  <div class="container-fluid ">
    <h1 class="pb-2 border-bottom">
      Show Math Course <%= course.name %></h1>
    <div class="p-2">
        <%= course.description %>
        <br>
        Created at <%= course.createdAt %>
    </div>
      <h1>Mastery Summary</h1>
      <table class="table table-bordered table-striped js-sort-table">
        <thead>
            <tr>
                <th>Name</th>
                <th>Email</th>
                <th>Section</th>
                <th>Fskills</th>
                <th>Gskills</th>
                <% for (let skill of skillSet) { %>
                    <th 
                       <% if (skillCounts[skill]==studentCount){ %> 
                            class="bg-warning"
                       <% } else { 
                            let cm = 100*skillCounts[skill] / studentCount;
                            let b = 255 - cm*2.55;
                            let r = cm*2.55;
                           %> 
                           style="font-weight:bold;color:rgb(<%= r %>,0,<%= b %>)"
                        <% } %>
                       >
                      <%= skill %>
                    <br>
                    <%= skillCounts[skill] %>/<%= studentCount %>
                    </th>
                <% } %>
            </tr>
        </thead>
        <tbody>
            <% for (let email in mastery) {
              %>
                <tr>
                    <td><%= mastery[email]['name'] %></td>
                    <td class="<%= email.endsWith("@brandeis.edu")?"":
                    "bg-warning" %>"

                        ><%= email %></td>
                    <td><%= sectionDict[email] %></td>
                    <td><%= mastery[email]['Fskills'] %></td>
                    <td><%= mastery[email]['Gskills'] %></td>
                    <% for (let skill of skillSet) { 
                        let m =mastery[email][skill];
                        if (m === undefined) {
                            m = 0;
                        }
                        %>
                        <td><%= m %></td>
                    <% } %>
                </tr>
            <% } %>
        </tbody>
      </table>
  </div>
</div>

<%- include('../bootfooter') -%>
<%- include('../htmlfoot') -%>